!configdict
badpix: median

#TODO move this to data.yml? -Jeb
beammap: !bmap
  file: /mnt/data0/baileyji/mec/finalMap_20181218.bmap
  freqfiles: /mnt/data0/baileyji/mec/psfreq_dec/ps_freqs_FL*_clip.txt
  nrows: 146
  ncols: 140

paths: !configdict
    dithers: /mnt/data0/baileyji/mec/dithers/
    data: /mnt/data0/ScienceData/Subaru/
    #a processing cache directory, calibrations, configs, etc will be retrieved/stored here
    database: /mnt/data0/steiger/MEC/
    out: /mnt/data0/baileyji/mec/out/
    tmp: /mnt/data0/baileyji/mec/scratch/  #(optional) can be used to specify a location for data intensive temp files

ncpu: 7
include_baseline: False # whether to include the baseline in h5 creation

linearity: !configdict
  dt: 500000 #time window around which to calculate the linearity weight (microsesonds)

wavecal: !configdict
  plots: summary
  fit: !configdict
    # model types from wavecal_models.py to attempt to fit to the phase peak histograms
    # (list of strings)
    histogram_model_names: ['GaussianAndExponential']
    # minimum bin width for the phase histogram. Larger widths will be used for low photon
    # count pixels (number)
    bin_width: 2
    # how many times should the code try to fit each histogram model before giving up
    histogram_fit_attempts: 3
    # model types from wavecal_models.py to attempt to fit to the phase-energy relationship
    # (list of strings)
    calibration_model_names: ['Quadratic', 'Linear']
    # ignore photons which arrive this many microseconds from another photon (number)
    dt: 500
    # do the fitting using more than one core (True/False)
    parallel: True
    parallel_prefetch: False

spectralcal: !configdict
  #Mandatory
  photometry_type: 'aperture' #'aperture' or 'psf'
  aperture_radius: 6 #in pixels
  summary_plot: True
  sky_position: (60, 170) #location center reference sky pixel
  #optional
  #url link to a standard spectrum text file must be in 2 column format where first column is wvl in angstroms and
  #second column is flux in erg/s/cm^2/A
  standard_url: '/mnt/data0/steiger/MEC/20200705/spectra/BD_172803_spectrum_PHEONIX.txt'
  object_position: (93, 134) #in pixel coordinates - if blank the code will attempt to locate the object location
  interpolation: 'linear' #'linear', 'cubic' or 'nearest'

flatcal: !configdict
  #This section provides the parameters specific to the flat calibration function
  method: 'Laser' #either 'White' for a white light calibration or 'Laser' for a laser calibration
  rate_cutoff: 20000 #Count Rate Cutoff in inverse seconds (number)
  trim_fraction: 0 #Fraction of Chunks to trim (integer)
  #Integration time to break up larger h5 files into in seconds (number) (5 sec recommended)
  #Flatcal will calculate weights over EXPTIME/CHUNK_TIME time chunks and median-average them
  chunk_time: 30
  dark_data:
    start_times: 1567945938 #list of all start times of any dark obs you may have
    int_times: 30 # list of how long each of those dark obs was
  power: 2
  plots: summary  # None|summary|all  (all will add ~30 min to the process!)

instrument: !configdict
  #This section provides information about the specific wavelength and energy parameters for this instrument
  #deadtime (number)
  deadtime: 0.000001
  #Energy bin width in eV  (number)
  energy_bin_width: 0.01
  #Starting Wavelength in nanometers (number)
  wvl_start: 400
  #Final Wavelength in nanometers (number)
  wvl_stop: 1400
  platescale: 10.4 #mas

drizzler: !configdict
  plots: all
  pixfrac: 0.5
  exp_timestep: 1  # duration of the time bins in the output cube
  wcs_timestep: 1  # time between different wcs parameters (eg orientations). 0 will use the calculated non-blurring min
  nwvlbins: 1  # the number of equal width bins in the temporally drizzled cube
  usecache: False  # if True the reformatted photontable data from each of the dithers is stored and reloaded for
                   # subsequent runs of drizzler.py
  derotate: False  # apply a rotation to each frame opposite to the sky rotation to align the objects
  align_start_pa: False  # if derotate is False then the images can be aligned to the first frame for the purpose of ADI
  whitelight: True  # tell drizzler to turn off derotation and set ra and dec to 0

templar: !configdict
  file: the_conf.yml

verbose: True
